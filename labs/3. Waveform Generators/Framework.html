<script type="text/javascript">
  $(document).ready(function(){
    function map_range(value, low1, high1, low2, high2) {
    return low2 + (high2 - low2) * (value - low1) / (high1 - low1);
}
function setAnalog1(){
  const rVal1 =  parseFloat($("component[data-spice-name='RVariable1']").attr("data-spice-value").replace(/[^0-9\.]/g,''));
  const rVal2 =  parseFloat($("component[data-spice-name='RVariable2']").attr("data-spice-value").replace(/[^0-9\.]/g,''));
  const negValue = parseInt($("component[data-spice-name='RVariable2'] port[name='-']").attr("data-spice-node"));
  console.log(rVal1);
  console.log(rVal2);
  var ratio = rVal1/rVal2;
  console.log(ratio);
  var maxVoltage = 15.0;
  var minVoltage = -15.0;
  if(negValue == 0)
    minVoltage = 0.0;
  var analogValue = minVoltage+(maxVoltage-minVoltage)*(rVal2/(rVal1+rVal2));
  console.log("Voltage at intermediate node:")
  console.log(analogValue);
  analogValue = map_range(analogValue,minVoltage,maxVoltage,0,5);
  return analogValue;
}
$("a[data-action='check']").click(function(){
  console.log("Setting Analog Value:"+setAnalog1());
  $("button[data-action='implement']").attr("data-analog",JSON.stringify([setAnalog1(),0.0]));
})
$("component[data-spice-name='XA']").css("top","400px").css("left","150px").attr("disabled",true);
$("component[data-spice-name='XB']").css("top","189px").css("left","650px").attr("disabled",true);
$("component[data-spice-name='XC']").css("top","189px").css("left","150px").attr("disabled",true);
$("component[data-spice-name='XD']").css("top","400px").css("left","700px").attr("disabled",true);
$("component[data-spice-name='RVariable1']").attr("data-spice-maxvalue","10k");
$("component[data-spice-name='RVariable2']").attr("data-spice-maxvalue","10k");
})

</script>
<wire id='wire0' data-spice-node="0" data-spice-collapse-node='false' style="position: absolute;left:150px;width:50px;top:250px;height:6px;z-index: 0;background:black"></wire>
<wire id='wire1' data-spice-node="10" data-spice-collapse-node='false' style="position: absolute;left:150px;width:50px;top:280px;height:6px;z-index: 0;background:black"></wire>
<wire id='wire2' data-spice-node="8" data-spice-collapse-node='false' style="position: absolute;left:300px;width: 50px;top:280px;height:6px;z-index: 0;background:black"></wire>

<wire id='wire3' data-spice-node="6" data-spice-collapse-node='false' style="position: absolute;left:550px;width:50px;top:250px;height:6px;z-index: 0;background:black"></wire>
<wire id='wire4' data-spice-node="7" data-spice-collapse-node='false' style="position: absolute;left:800px;width: 50px;top:280px;height:6px;z-index: 0;background:black"></wire>

<wire id='wire3' data-spice-node="2" data-spice-collapse-node='false' style="position: absolute;left:450px;width:50px;top:450px;height:6px;z-index: 0;background:black"></wire>
<wire id='wire3' data-spice-node="3" data-spice-collapse-node='false' style="position: absolute;left:600px;width:50px;top:450px;height:6px;z-index: 0;background:black"></wire>


<wire id='wire5' data-spice-node="11" data-spice-collapse-node='false' style="position: absolute;left:1000px;height:150px;top:400px;width:6px;z-index: 0;background:black"></wire>
<wire id='wire6' data-spice-node="4" data-spice-collapse-node='false' style="position: absolute;left:75px;height:150px;top:100px;width:6px;z-index: 0;background:black"></wire>
<wire id='wire7' data-spice-node="5" data-spice-collapse-node='false' style="position: absolute;left:375px;height:6px;top:544px;width:200px;z-index: 0;background:black"></wire>